<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>불변성을 유지하며 state 핸들링하기 | 개발로그</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-C43W54E093"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C43W54E093');</script>
    <meta name="description" content="React immutable state">
    <meta property="og:title" content="React immutable">
    <meta property="og:description" content="React immutable">
    <meta property="og:url" content="https://wendypop.github.io/blog/React/immutable" tags="react,immutable,spread,react_state,reference-type">
    
    <link rel="preload" href="/blog/assets/css/0.styles.8d61e5b9.css" as="style"><link rel="preload" href="/blog/assets/js/app.598b797b.js" as="script"><link rel="preload" href="/blog/assets/js/18.22019e13.js" as="script"><link rel="preload" href="/blog/assets/js/2.77406796.js" as="script"><link rel="preload" href="/blog/assets/js/25.1c448fdd.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.1bf7fbc0.js"><link rel="prefetch" href="/blog/assets/js/11.70bf52e9.js"><link rel="prefetch" href="/blog/assets/js/12.a43fcbde.js"><link rel="prefetch" href="/blog/assets/js/13.47eb3c0b.js"><link rel="prefetch" href="/blog/assets/js/14.74548f6c.js"><link rel="prefetch" href="/blog/assets/js/15.b5df445e.js"><link rel="prefetch" href="/blog/assets/js/16.2da6ba90.js"><link rel="prefetch" href="/blog/assets/js/17.8d4a13e7.js"><link rel="prefetch" href="/blog/assets/js/19.a7bcae20.js"><link rel="prefetch" href="/blog/assets/js/20.42aeecb3.js"><link rel="prefetch" href="/blog/assets/js/21.a0734284.js"><link rel="prefetch" href="/blog/assets/js/22.63fb8265.js"><link rel="prefetch" href="/blog/assets/js/23.76bc34c0.js"><link rel="prefetch" href="/blog/assets/js/24.3b6deb67.js"><link rel="prefetch" href="/blog/assets/js/26.d376ca44.js"><link rel="prefetch" href="/blog/assets/js/27.3d26dfaa.js"><link rel="prefetch" href="/blog/assets/js/28.207d98b9.js"><link rel="prefetch" href="/blog/assets/js/29.39c4039c.js"><link rel="prefetch" href="/blog/assets/js/3.e64b9147.js"><link rel="prefetch" href="/blog/assets/js/30.eccf2cba.js"><link rel="prefetch" href="/blog/assets/js/31.ac838fdb.js"><link rel="prefetch" href="/blog/assets/js/32.3f65c2f4.js"><link rel="prefetch" href="/blog/assets/js/33.1b9f105d.js"><link rel="prefetch" href="/blog/assets/js/34.42e4dc3e.js"><link rel="prefetch" href="/blog/assets/js/4.81e4e6d1.js"><link rel="prefetch" href="/blog/assets/js/5.731c729c.js"><link rel="prefetch" href="/blog/assets/js/6.79beabb6.js"><link rel="prefetch" href="/blog/assets/js/7.4bd3e06c.js"><link rel="prefetch" href="/blog/assets/js/8.59cbf34e.js"><link rel="prefetch" href="/blog/assets/js/9.524babeb.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.8d61e5b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-c1e9910e><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">개발로그</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/React/" class="nav-link router-link-active">
  React
</a></div><div class="nav-item"><a href="/blog/UI/" class="nav-link">
  UI
</a></div><div class="nav-item"><a href="/blog/CSS/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/JS/" class="nav-link">
  JS
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/React/" class="nav-link router-link-active">
  React
</a></div><div class="nav-item"><a href="/blog/UI/" class="nav-link">
  UI
</a></div><div class="nav-item"><a href="/blog/CSS/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/JS/" class="nav-link">
  JS
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/blog/React/" aria-current="page" class="sidebar-link">리액트 개발 로그</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>react-core</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/React/react-core/immutable/" aria-current="page" class="active sidebar-link">불변성을 유지하며 state 핸들링하기</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/React/react-core/immutable/#배열-state-핸들링" class="sidebar-link">배열 state 핸들링</a></li><li class="sidebar-sub-header"><a href="/blog/React/react-core/immutable/#객체-state-핸들링" class="sidebar-link">객체 state 핸들링</a></li></ul></li><li><a href="/blog/React/react-core/webpack-bundle-analyze/" class="sidebar-link">컴포넌트 lazy load</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="불변성을-유지하며-state-핸들링하기"><a href="#불변성을-유지하며-state-핸들링하기" class="header-anchor">#</a> 불변성을 유지하며 state 핸들링하기</h1> <p>리액트에서는 불변성을 지키면서 상태를 변화시켜야 합니다.</p> <p>즉 리액트가 아닌 프로젝트에서는 이부분을 신경쓰지 않아도 됩니다.
바닐라 스크립트나 Vue로 개발시에는 신경쓰지 않아도 되는 부분이 리액트를 하면서 알게 된 부분을
정리해봅니다.</p> <p>상태를 변경한다는 것은 데이터를 변경한다는 것이고,
모던 프레임워크에서는 상태(데이터)가 변화하면 화면이 업데이트 됩니다.
vue로 개발시에는 어떤 타입의 상태든 그 상태를 변경시키면 화면이 업데이트 되었습니다.</p> <p>하지만 리액트에서는 불변성을 지키면서 상태를 변화시켜야 합니다.</p> <p>원시타입( string, number, boolean 등) state 는 메모리 참조형태가 아닙니다.
이렇게 원시타입 데이터를 리액트의 state 변수에 저장해도 참조 관계가 생기지 않습니다.
이렇게 참조가 생기지 않은 상황에서 state 변수값을 변경하는 것을 복사 한다고 합니다. 리액트는 state가 변경되었다고
판단되어 가상돔을 다시 랜더링합니다. 하여 state 변경 시 신경써야할 부분이 적지만
원시타입이 아닌 reference 타입(객체, 배열 등)의 객체는 원본만 변경하면 참조는 그대로라 리액트가 state 변화를 감지하지 못합니다.</p> <p><code>리액트가 state 변화를 감시하여 가상 돔을 다시 그리는 프로세스를 이해하면 좋습니다.</code></p> <p><code>요약하자면 메모리 포인터가 참조하고 있는 reference 타입의 객체들의 원본만 바꾸는게 아닌 새로운 객체를 전달하여 메모리 포인터까지 변경 해야 리액트가 state 변화를 감지하여 화면을 갱신합니다.</code></p> <h3 id="원본을-변경하는-부수효과가-있는-메서드"><a href="#원본을-변경하는-부수효과가-있는-메서드" class="header-anchor">#</a> 원본을 변경하는 부수효과가 있는 메서드</h3> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>초창기 배열 메서드는 원본을 변경하는 부수효과 있는 메서드들이 있습니다.</p></div> <ol><li><p>원본 배열을 직접 변경하는 메서드 ( mutator method )<br>
Array.prototype.push()<br>
Array.prototype.pop()<br>
Array.prototype.unshift()<br>
Array.prototype.shift()<br>
Array.prototype.splice()<br>
Array.prototype.slice()<br>
Array.prototype.join()<br>
Array.prototype.fill()<br>
Array.prototype.sort()</p></li> <li><p>원본 배열을 직접 변경하지 않고 새로운 배열을 생성하여 반환하는 메서드 ( accessor method )
Array.prototype.concat()  -&gt; 스프레드 문법으로 대체 가능<br>
Array.prototype.map()<br>
Array.prototype.filter()<br>
Array.prototype.reduce()<br>
Array.prototype.find()<br>
또는 ES6의 스프레드 문법</p></li></ol> <h2 id="배열-state-핸들링"><a href="#배열-state-핸들링" class="header-anchor">#</a> 배열 state 핸들링</h2> <h4 id="배열에-추가"><a href="#배열에-추가" class="header-anchor">#</a> 배열에 추가</h4> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token comment">// zustand </span>
<span class="token function-variable function">setTag</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">_new</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">specialTags</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token operator">...</span>state<span class="token punctuation">.</span>specialTags<span class="token punctuation">,</span> _new<span class="token punctuation">.</span>specialTags <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br></div><pre class="language-js"><code><span class="token keyword">let</span> array1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> array2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token function">setList</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>array1<span class="token punctuation">,</span> <span class="token operator">...</span>array2<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setUsers</span><span class="token punctuation">(</span>state<span class="token punctuation">.</span>array<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>newArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setWord</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">[</span>newWord<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// [1, 2].concat([3, 4])</span>
<span class="token comment">// [...[1, 2], ...[3, 4]]</span>
</code></pre></div><h4 id="배열-수정"><a href="#배열-수정" class="header-anchor">#</a> 배열 수정</h4> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">onToggle</span> <span class="token operator">=</span> <span class="token parameter">id</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setUsers</span><span class="token punctuation">(</span>
    users<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">user</span> <span class="token operator">=&gt;</span>
        user<span class="token punctuation">.</span>id <span class="token operator">===</span> id <span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token operator">...</span>user<span class="token punctuation">,</span> <span class="token literal-property property">active</span><span class="token operator">:</span> <span class="token operator">!</span>user<span class="token punctuation">.</span>active <span class="token punctuation">}</span> <span class="token operator">:</span> user
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">setList</span><span class="token punctuation">(</span><span class="token parameter">_old</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token operator">...</span>_old<span class="token punctuation">,</span> newList<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>map 함수도 새로운 배열을 반환하기 때문에 불변성을 유지하며, state 변경이 가능합니다.</p> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-js"><code><span class="token function">setRelateProductList</span><span class="token punctuation">(</span>
    products<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> new_product <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>item<span class="token punctuation">,</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span> item<span class="token punctuation">.</span>id<span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> item<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
            <span class="token literal-property property">image</span><span class="token operator">:</span> item<span class="token punctuation">.</span>image
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> new_product
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h4 id="배열-삭제"><a href="#배열-삭제" class="header-anchor">#</a> 배열 삭제</h4> <div class="language-js extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token comment">// 매개변수 id 에 해당하는 것을 삭제 </span>
<span class="token keyword">const</span> <span class="token function-variable function">filter</span> <span class="token operator">=</span> <span class="token parameter">id</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setList</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>id <span class="token operator">!==</span> id<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h2 id="객체-state-핸들링"><a href="#객체-state-핸들링" class="header-anchor">#</a> 객체 state 핸들링</h2> <h4 id="객체-추가"><a href="#객체-추가" class="header-anchor">#</a> 객체 추가</h4> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br></div><pre class="language-js"><code>  <span class="token function">setDetail</span><span class="token punctuation">(</span><span class="token punctuation">(</span> <span class="token parameter">prev</span> <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>prev<span class="token punctuation">,</span> <span class="token operator">...</span>current <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ES6 Object.aasign 메서드를 이용 가능</span>
<span class="token keyword">let</span> merged1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">c</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> changed1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> merged2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">...</span><span class="token punctuation">{</span><span class="token literal-property property">a</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> changed2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> added <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">k</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>

</code></pre></div><h4 id="객체-수정"><a href="#객체-수정" class="header-anchor">#</a> 객체 수정</h4> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code><span class="token comment">// state 변수 수정</span>
<span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> value<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// redux </span>
<span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token literal-property property">all</span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> payload <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token literal-property property">title</span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">title</span> <span class="token operator">:</span> payload <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token literal-property property">content</span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> payload <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token literal-property property">created</span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">createdAt</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toISOString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
  <span class="token keyword">default</span><span class="token operator">:</span> <span class="token keyword">return</span> state
<span class="token punctuation">}</span>
</code></pre></div><h4 id="배열-내-객체-수정"><a href="#배열-내-객체-수정" class="header-anchor">#</a> 배열 내 객체 수정</h4> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>  <span class="token function">setOption</span><span class="token punctuation">(</span>
    options<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">option</span> <span class="token operator">=&gt;</span>
      <span class="token comment">// 기존 selected: false 토글! </span>
      option<span class="token punctuation">.</span>type <span class="token operator">===</span> item<span class="token punctuation">.</span>type <span class="token operator">?</span> <span class="token punctuation">{</span> <span class="token operator">...</span>option<span class="token punctuation">,</span> <span class="token literal-property property">selected</span><span class="token operator">:</span> <span class="token operator">!</span>option<span class="token punctuation">.</span>selected <span class="token punctuation">}</span> <span class="token operator">:</span> option
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
</code></pre></div><div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-js"><code>  <span class="token keyword">const</span> initial <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'car'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">selected</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">childObj</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">carType1</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">carType2</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">carType3</span> <span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'area'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">selected</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token literal-property property">childObj</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">area1</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">area2</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token literal-property property">area3</span> <span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>

  <span class="token keyword">const</span> <span class="token punctuation">[</span> option<span class="token punctuation">,</span> setOption <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initial<span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> sub<span class="token punctuation">,</span> setSub <span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initial<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

  <span class="token function">setOption</span><span class="token punctuation">(</span>
      option<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">opt</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 여러 속성 수정</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>opt<span class="token punctuation">,</span> <span class="token literal-property property">selected</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">childObj</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>arg<span class="token punctuation">.</span>childObj <span class="token punctuation">}</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>

  <span class="token function">setSub</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">childObj</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>arg<span class="token punctuation">.</span>childObj <span class="token punctuation">}</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token comment">// zustand</span>
  <span class="token keyword">const</span> initialDialog <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'confirm'</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">export</span> <span class="token keyword">const</span> useDialog <span class="token operator">=</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">set</span></span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">dialogs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">dialog</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>initialDialog <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">setDialogShow</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">_new</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_old</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">dialogs</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>_old<span class="token punctuation">.</span>dialogs<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token operator">...</span>_old<span class="token punctuation">.</span>dialog<span class="token punctuation">,</span> <span class="token operator">...</span>_new<span class="token punctuation">,</span> <span class="token literal-property property">show</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">setDialogHide</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">_old</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">dialogs</span><span class="token operator">:</span> _old<span class="token punctuation">.</span>dialogs<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> index <span class="token operator">&lt;</span> _old<span class="token punctuation">.</span>dialogs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="객체-내-배열-수정"><a href="#객체-내-배열-수정" class="header-anchor">#</a> 객체 내 배열 수정</h4> <div class="language-js extra-class"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">case</span> <span class="token literal-property property">add_user</span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>users<span class="token punctuation">,</span> action<span class="token punctuation">.</span>payload <span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token literal-property property">del_user</span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>state<span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">s</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> s<span class="token punctuation">.</span>id <span class="token operator">!==</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token keyword">case</span> <span class="token literal-property property">clear_all</span><span class="token operator">:</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> <span class="token literal-property property">users</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
  <span class="token keyword">default</span><span class="token operator">:</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/29/2022, 2:59:02 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/React/" class="prev router-link-active">
        리액트 개발 로그
      </a></span> <span class="next"><a href="/blog/React/react-core/webpack-bundle-analyze/">
        컴포넌트 lazy load
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.598b797b.js" defer></script><script src="/blog/assets/js/18.22019e13.js" defer></script><script src="/blog/assets/js/2.77406796.js" defer></script><script src="/blog/assets/js/25.1c448fdd.js" defer></script>
  </body>
</html>
