<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ajax 실행 단계 | 개발로그</title>
    <meta name="generator" content="VuePress 1.9.7">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-C43W54E093"></script>
    <script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-C43W54E093');</script>
    <meta name="description" content="Ajax 실행 단계, callback, promise, XMLHttpRequest, async await">
    <meta property="og:title" content="Ajax 실행 단계, callback, promise, XMLHttpRequest, async await">
    <meta property="og:description" content="Ajax 실행 단계, callback, promise, XMLHttpRequest, async await">
    <meta property="og:url" content="https://kyounghwan01.github.io/blog/JS/Ajax/AjaxStep/">
    
    <link rel="preload" href="/blog/assets/css/0.styles.8d61e5b9.css" as="style"><link rel="preload" href="/blog/assets/js/app.598b797b.js" as="script"><link rel="preload" href="/blog/assets/js/18.22019e13.js" as="script"><link rel="preload" href="/blog/assets/js/2.77406796.js" as="script"><link rel="preload" href="/blog/assets/js/27.3d26dfaa.js" as="script"><link rel="preload" href="/blog/assets/js/17.8d4a13e7.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.1bf7fbc0.js"><link rel="prefetch" href="/blog/assets/js/11.70bf52e9.js"><link rel="prefetch" href="/blog/assets/js/12.a43fcbde.js"><link rel="prefetch" href="/blog/assets/js/13.47eb3c0b.js"><link rel="prefetch" href="/blog/assets/js/14.74548f6c.js"><link rel="prefetch" href="/blog/assets/js/15.b5df445e.js"><link rel="prefetch" href="/blog/assets/js/16.2da6ba90.js"><link rel="prefetch" href="/blog/assets/js/19.a7bcae20.js"><link rel="prefetch" href="/blog/assets/js/20.42aeecb3.js"><link rel="prefetch" href="/blog/assets/js/21.a0734284.js"><link rel="prefetch" href="/blog/assets/js/22.63fb8265.js"><link rel="prefetch" href="/blog/assets/js/23.76bc34c0.js"><link rel="prefetch" href="/blog/assets/js/24.3b6deb67.js"><link rel="prefetch" href="/blog/assets/js/25.1c448fdd.js"><link rel="prefetch" href="/blog/assets/js/26.d376ca44.js"><link rel="prefetch" href="/blog/assets/js/28.207d98b9.js"><link rel="prefetch" href="/blog/assets/js/29.39c4039c.js"><link rel="prefetch" href="/blog/assets/js/3.e64b9147.js"><link rel="prefetch" href="/blog/assets/js/30.eccf2cba.js"><link rel="prefetch" href="/blog/assets/js/31.ac838fdb.js"><link rel="prefetch" href="/blog/assets/js/32.3f65c2f4.js"><link rel="prefetch" href="/blog/assets/js/33.1b9f105d.js"><link rel="prefetch" href="/blog/assets/js/34.42e4dc3e.js"><link rel="prefetch" href="/blog/assets/js/4.81e4e6d1.js"><link rel="prefetch" href="/blog/assets/js/5.731c729c.js"><link rel="prefetch" href="/blog/assets/js/6.79beabb6.js"><link rel="prefetch" href="/blog/assets/js/7.4bd3e06c.js"><link rel="prefetch" href="/blog/assets/js/8.59cbf34e.js"><link rel="prefetch" href="/blog/assets/js/9.524babeb.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.8d61e5b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-c1e9910e><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><!----> <span class="site-name">개발로그</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/React/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/UI/" class="nav-link">
  UI
</a></div><div class="nav-item"><a href="/blog/CSS/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/JS/" class="nav-link">
  JS
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/React/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/blog/UI/" class="nav-link">
  UI
</a></div><div class="nav-item"><a href="/blog/CSS/" class="nav-link">
  CSS
</a></div><div class="nav-item"><a href="/blog/JS/" class="nav-link">
  JS
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ajax-실행-단계"><a href="#ajax-실행-단계" class="header-anchor">#</a> Ajax 실행 단계</h1> <p>아래 순서대로 설명하겠습니다</p> <blockquote><ol><li>XMLHttpRequest (요청) 객체 생성</li> <li>처리 결과를 받을 이벤트 리스너 등록</li> <li>서버로 보낼 데이터 생성</li> <li>클라이언트와 서버 간의 연결 요청 준비 (<code>open()</code> 메서드 사용)
<ol><li>서버로 보낼 데이터 전송방식 설정 (GET, POST)</li> <li>서버 응답 방식 설정 (동기, 비동기)</li></ol></li> <li>실제 데이터 전송</li> <li>응답 처리</li> <li>데이터 처리</li></ol></blockquote> <h2 id="_1-xmlhttprequest란"><a href="#_1-xmlhttprequest란" class="header-anchor">#</a> 1. XMLHttpRequest란?</h2> <blockquote><p>XMLHttpRequest 객체는 서버와 클라이언트 간 통신을 담당하는 객체입니다.
Ajax를 통해 서버통신을 할 때 가장 먼저 생성해야 할 객체입니다.</p></blockquote> <p>아래는 XMLHttpRequest 객체를 생성하는 코드입니다.</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> xmlHttp <span class="token operator">=</span> <span class="token function">createXMLHTTPObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 브라우저에 따른 XMLHttpRequest 생성</span>
<span class="token keyword">function</span> <span class="token function">createXMLHTTPObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>XMLHttpRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// IE7+, 크롬, 사파리, 파폭, 오페라는 XMLHttpRequest 객체를 제공합니다.</span>
    xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// IE5,6 버전</span>
    xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ActiveXObject</span><span class="token punctuation">(</span><span class="token string">&quot;Microsoft.XMLHTTP&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> xhr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>위 코드는 mdn에도 나와 있는 초기 객체 생성의 공식같은 내용입니다.</p> <h3 id="_1-1-xmlhttprequest의-주요-메서드"><a href="#_1-1-xmlhttprequest의-주요-메서드" class="header-anchor">#</a> 1.1 XMLHttpRequest의 주요 메서드</h3> <ol><li><code>open(method , url , async)</code>: return 없음
두번째 매개변수 url이 요청 대상 url 입니다.
첫번째 매개변수는 get,post로 나뉘며 get의 경우 두번째 url으로 부터 정보를 받습니다. post는 두번째 매개변수 url로 정보를 보냅니다.
세번째 매개변수는 요청에 대한 응답을 기다리는 방식으로 true : 비동기 (기본값), false 동기 입니다.</li> <li><code>send(data)</code>: return 없음
http 요청을 실제로 실행하는 메소드 (data : POST방식으로 보낼 데이터)
이 메소드가 실행돼야 요청이 서버로 전달됩니다.</li></ol> <h3 id="_1-2-xmlhttprequest의-주요-프로퍼티"><a href="#_1-2-xmlhttprequest의-주요-프로퍼티" class="header-anchor">#</a> 1.2 XMLHttpRequest의 주요 프로퍼티</h3> <ol><li><code>readyState</code>:
요청 상태를 나타내며, 이 프로퍼티를 이용하면 클라이언트와 서버간 데이터 통신이 현재 어디까지 진행됬는지 확인 가능합니다.
0 : 초기화 되지 않은 상태
1 : 로드되지 않은 상태 (즉, send() 메소드가 호출되지 않은 상태)
2 : 로드된 상태, 헤더와 상태는 받았으나 아직 응답을 받지 못한 상태
3 : 상호 작용 상태. 데이터의 일부분만 받은 상태
4 : 완료 상태</li> <li><code>onreadystatechange</code> :
요청 상태가 변경될 때 발생하는 이벤트 입니다.</li> <li><code>responseText</code> :
서버 응답에 반환된 본문 콘텐츠 입니다</li> <li><code>responseXML</code> :
서버 응답이 xml이면 xml 본문 콘텐츠로 채워집니다.</li> <li><code>state</code>:
서버 응답상태
200 = 성공
404 = 페이지를 찾을 수 없음</li> <li><code>statusText</code> :
응답으로 반환된 상태 메세지 입니다.</li></ol> <h2 id="_2-처리-결과를-받을-이벤트-리스너-등록"><a href="#_2-처리-결과를-받을-이벤트-리스너-등록" class="header-anchor">#</a> 2. 처리 결과를 받을 이벤트 리스너 등록</h2> <p>위에 쓰인 <code>onreadystatechange</code> 이벤트는 클라이언트와 서버 간의 데이터 전송 상태가 바뀔 때마다 발생하는 이벤트 입니다.
즉, <strong>서버가 클라이언트에서 요청한 응답으로 보내는 데이터를 얻으려면 이 이벤트</strong>를 사용해야한다는 것입니다. 이를 위해서는 먼저 실제 데이터 전송이 이뤄지기 전 이벤트 리스너를 등록해야 합니다.</p> <div class="language-js extra-class"><pre class="language-js"><code>xmlHttp<span class="token punctuation">.</span>onreadystatechange <span class="token operator">=</span> on_ReadyStateChange<span class="token punctuation">;</span>
</code></pre></div><p>이후 <code>open()</code> 메소드 ( 연결 요청 준비 단계 )와 <code>send()</code> 메소드 ( 실제 데이터 전송 )가 이루어지면 앞의 코드와 이벤트 리스너로 등록한 <code>on_ReadyStateChange()</code>리스너 함수가 실행되고 데이터를 주고 받는 과정에서 통신이 정상적으로 이루어 졌다면 그 통신의 시점만 알아내면 됩니다.</p> <p>통신 시점의 상태 알아내는 코드</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 응답 처리</span>
<span class="token keyword">function</span> <span class="token function">on_ReadyStateChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * 0 = 초기화 전
   * 1 = 로딩 중
   * 2 = 로딩 됨
   * 3 = 대화 상태
   * 4 = 데이터 전송완료
   */</span>
  <span class="token comment">// 4 = 데이터 전송완료</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttp<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 200 = 통신 성공, 404 = 페이지가 존재하지 않음</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>xmlHttp<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">/**
       * ----------------------------------
       * 이 영역에서 서버에서 보낸 데이터를
       * 타입(XML, JSON, CSV) 에 따라 처리
       * ----------------------------------
       */</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;error!.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>정상적으로 통신이 이루어졌다면 이때 서버에서 보내온 데이터가 담긴 responseText와 responseXML프로퍼티를 이용하면 됩니다.</p> <TagLinks></TagLinks> <div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/6/2022, 12:40:33 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.598b797b.js" defer></script><script src="/blog/assets/js/18.22019e13.js" defer></script><script src="/blog/assets/js/2.77406796.js" defer></script><script src="/blog/assets/js/27.3d26dfaa.js" defer></script><script src="/blog/assets/js/17.8d4a13e7.js" defer></script>
  </body>
</html>
